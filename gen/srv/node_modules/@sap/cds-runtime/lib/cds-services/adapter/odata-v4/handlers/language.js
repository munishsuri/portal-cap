const cds = global.cds || require('@sap/cds/lib')
const { toODataResult } = require('../utils/event')

module.exports = (req, res, next) => {
  const _ = {
    req: req.getIncomingRequest(),
    odataReq: req
  }
  const user = new cds.User()
  Object.defineProperty(user, '_req', { enumerable: false, value: _.req })
  const locale = user.locale
  next(null, toODataResult(locale))
}
