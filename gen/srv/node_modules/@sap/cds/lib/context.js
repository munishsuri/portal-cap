exports.for = (cds,v) => { if (cds.env.features.cls) {

  const [,major,minor] = /v(\d+)\.(\d+)/.exec(process.version)
  if (major > 12 || major == 12 && minor >= 18) {

    const { executionAsyncResource:current, createHook } = module.require ('async_hooks')
    const _context = Symbol('cds.req.context')

    createHook ({  init(id,t,tid, res) {
      res[_context] = current()[_context]
    }}).enable()

    Reflect.defineProperty (cds,'context',{ enumerable:1,
      set(v) { current()[_context] = v && v.context || v },
      get:()=> current()[_context],
    })

  } else {

    Reflect.defineProperty (cds,'context',{ enumerable:1,
      get:()=> undefined,
      set:()=> {},
    })

  }

  return v ? cds.context = v : cds.context

}}
